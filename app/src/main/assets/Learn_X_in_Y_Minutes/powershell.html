<!DOCTYPE html lang="en-us" xml:lang="en-us" xmlns="http://www.w3.org/1999/xhtml">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta http-equiv="Content-Language" content="en-us">
        <!-- Use title if it's in the page YAML frontmatter -->
        <title>Learn X in Y Minutes: Scenic Programming Language Tours</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="index.css">

        <link rel="canonical" href="https://learnxinyminutes.com/docs/powershell/">
        <script>
            function set_theme(theme) {
                var el = document.getElementsByTagName("html")[0];

                if (theme === "dark" ) {
                    el.className = "dark";
                } else {
                    el.className = "light";
                }

                localStorage.setItem("lxiym_theme", theme);
            }

            var theme = localStorage.getItem("lxiym_theme");
            if (theme) {
                set_theme(theme);
            }
        </script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
        <![endif]-->

        <div class="container">
            <div class="share">
    <span class="sharemsg">
      <a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Flearnxinyminutes.com%2Fdocs%2Fpowershell%2F&text=Learn+X+in+Y+minutes%2C+where+X%3Dpowershell">
        Share this page
      </a></span>

      <span class='st_facebook_large' displayText='Facebook'></span>
      <span class='st_twitter_large' displayText='Tweet'></span>
  </div>
  <div class="theme-choice">
    <label id="theme-label">Select theme:</label>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('light');">light</button>
    <button type="button" aria-labelledby="theme-label" onclick="set_theme('dark');">dark</button>
  </div>
  <h1><a href="/">Learn X in Y minutes</a></h2>
  <h2>Where X=powershell</h2>
    <p class="filelink">
    Get the code:
    <a href="/docs/files/LearnPowershell.ps1">LearnPowershell.ps1</a>
    </p>
  <div id="doc">
    <p>PowerShell is the Windows scripting language and configuration management
framework from Microsoft built on the .NET Framework. Windows 7 and up ship
with PowerShell.<br>
Nearly all examples below can be a part of a shell script or executed directly
in the shell.</p>

<p>A key difference with Bash is that it is mostly objects that you manipulate
rather than plain text.</p>

<p><a href="https://technet.microsoft.com/en-us/library/bb978526.aspx">Read more here.</a></p>

<p>If you are uncertain about your environment:</p>
<div class="highlight"><pre><span></span><span class="nb">Get-ExecutionPolicy</span> <span class="n">-List</span>
<span class="nb">Set-ExecutionPolicy</span> <span class="n">AllSigned</span>
<span class="c"># Execution policies include:</span>
<span class="c"># - Restricted: Scripts won&#39;t run.</span>
<span class="c"># - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. </span>
<span class="c"># - AllSigned: Scripts need to be signed by a trusted publisher.</span>
<span class="c"># - Unrestricted: Run all scripts.</span>
<span class="n">help</span> <span class="n">about_Execution_Policies</span> <span class="c"># for more info</span>

<span class="c"># Current PowerShell version:</span>
<span class="nv">$PSVersionTable</span>
</pre></div>
<p>Getting help:</p>
<div class="highlight"><pre><span></span><span class="c"># Find commands</span>
<span class="nb">Get-Command</span> <span class="n">about_</span><span class="p">*</span> <span class="c"># alias: gcm</span>
<span class="nb">Get-Command</span> <span class="n">-Verb</span> <span class="n">Add</span>
<span class="nb">Get-Alias</span> <span class="n">ps</span>
<span class="nb">Get-Alias</span> <span class="n">-Definition</span> <span class="nb">Get-Process</span>

<span class="nb">Get-Help</span> <span class="n">ps</span> <span class="p">|</span> <span class="n">less</span> <span class="c"># alias: help</span>
<span class="n">ps</span> <span class="p">|</span> <span class="nb">Get-Member</span> <span class="c"># alias: gm</span>

<span class="nb">Show-Command</span> <span class="nb">Get-EventLog</span> <span class="c"># Display GUI to fill in the parameters</span>

<span class="nb">Update-Help</span> <span class="c"># Run as admin</span>
</pre></div>
<p>The tutorial starts here:</p>
<div class="highlight"><pre><span></span><span class="c"># As you already figured, comments start with #</span>

<span class="c"># Simple hello world example:</span>
<span class="n">echo</span> <span class="n">Hello</span> <span class="n">world</span><span class="p">!</span>
<span class="c"># echo is an alias for Write-Output (=cmdlet)</span>
<span class="c"># Most cmdlets and functions follow the Verb-Noun naming convention</span>

<span class="c"># Each command starts on a new line, or after a semicolon:</span>
<span class="n">echo</span> <span class="s1">&#39;This is the first line&#39;</span><span class="p">;</span> <span class="n">echo</span> <span class="s1">&#39;This is the second line&#39;</span>

<span class="c"># Declaring a variable looks like this:</span>
<span class="nv">$aString</span><span class="p">=</span><span class="s2">&quot;Some string&quot;</span>
<span class="c"># Or like this:</span>
<span class="nv">$aNumber</span> <span class="p">=</span> <span class="n">5</span> <span class="o">-as</span> <span class="no">[double]</span>
<span class="nv">$aList</span> <span class="p">=</span> <span class="n">1</span><span class="p">,</span><span class="n">2</span><span class="p">,</span><span class="n">3</span><span class="p">,</span><span class="n">4</span><span class="p">,</span><span class="n">5</span>
<span class="nv">$anEmptyList</span> <span class="p">=</span> <span class="p">@()</span>
<span class="nv">$aString</span> <span class="p">=</span> <span class="nv">$aList</span> <span class="n">-join</span> <span class="s1">&#39;--&#39;</span> <span class="c"># yes, -split exists also</span>
<span class="nv">$aHashtable</span> <span class="p">=</span> <span class="p">@{</span><span class="n">name1</span><span class="p">=</span><span class="s1">&#39;val1&#39;</span><span class="p">;</span> <span class="n">name2</span><span class="p">=</span><span class="s1">&#39;val2&#39;</span><span class="p">}</span>

<span class="c"># Using variables:</span>
<span class="n">echo</span> <span class="nv">$aString</span>
<span class="n">echo</span> <span class="s2">&quot;Interpolation: $aString&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;$aString has length of </span><span class="p">$(</span><span class="nv">$aString</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span><span class="s2">&quot;</span>
<span class="n">echo</span> <span class="s1">&#39;$aString&#39;</span>
<span class="n">echo</span> <span class="sh">@&quot;</span>
<span class="sh">This is a Here-String</span>
<span class="sh">$aString</span>
<span class="sh">&quot;@</span>
<span class="c"># Note that &#39; (single quote) won&#39;t expand the variables!</span>
<span class="c"># Here-Strings also work with single quote</span>

<span class="c"># Builtin variables:</span>
<span class="c"># There are some useful builtin variables, like</span>
<span class="n">echo</span> <span class="s2">&quot;Booleans: $TRUE and $FALSE&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Empty value: $NULL&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Last program&#39;s return value: $?&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Exit code of last run Windows-based program: $LastExitCode&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;The last token in the last line received by the session: $$&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;The first token: $^&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Script&#39;s PID: $PID&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Full path of current script directory: $PSScriptRoot&quot;</span>
<span class="n">echo</span> <span class="s1">&#39;Full path of current script: &#39;</span> <span class="p">+</span> <span class="nv">$MyInvocation</span><span class="p">.</span><span class="n">MyCommand</span><span class="p">.</span><span class="n">Path</span>
<span class="n">echo</span> <span class="s2">&quot;FUll path of current directory: $Pwd&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Bound arguments in a function, script or code block: $PSBoundParameters&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Unbound arguments: </span><span class="p">$(</span><span class="nv">$Args</span> <span class="n">-join</span> <span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="s2">.&quot;</span>
<span class="c"># More builtins: `help about_Automatic_Variables`</span>

<span class="c"># Inline another file (dot operator)</span>
<span class="p">.</span> <span class="p">.\</span><span class="n">otherScriptName</span><span class="p">.</span><span class="n">ps1</span>


<span class="c">### Control Flow</span>
<span class="c"># We have the usual if structure:</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$Age</span> <span class="o">-is</span> <span class="no">[string]</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">echo</span> <span class="s1">&#39;But.. $Age cannot be a string!&#39;</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$Age</span> <span class="o">-lt</span> <span class="n">12</span> <span class="o">-and</span> <span class="nv">$Age</span> <span class="o">-gt</span> <span class="n">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">echo</span> <span class="s1">&#39;Child (Less than 12. Greater than 0)&#39;</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">echo</span> <span class="s1">&#39;Adult&#39;</span>
<span class="p">}</span>

<span class="c"># Switch statements are more powerful compared to most languages</span>
<span class="nv">$val</span> <span class="p">=</span> <span class="s2">&quot;20&quot;</span>
<span class="k">switch</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-eq</span> <span class="n">42</span> <span class="p">}</span>           <span class="p">{</span> <span class="s2">&quot;The answer equals 42&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="s1">&#39;20&#39;</span>                    <span class="p">{</span> <span class="s2">&quot;Exactly 20&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-like</span> <span class="s1">&#39;s*&#39;</span> <span class="p">}</span>       <span class="p">{</span> <span class="s2">&quot;Case insensitive&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-clike</span> <span class="s1">&#39;s*&#39;</span><span class="p">}</span>       <span class="p">{</span> <span class="s2">&quot;clike, ceq, cne for case sensitive&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="nv">$_</span> <span class="o">-notmatch</span> <span class="s1">&#39;^.*$&#39;</span><span class="p">}</span>  <span class="p">{</span> <span class="s2">&quot;Regex matching. cnotmatch, cnotlike, ...&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="p">{</span> <span class="s1">&#39;x&#39;</span> <span class="o">-contains</span> <span class="s1">&#39;x&#39;</span><span class="p">}</span>    <span class="p">{</span> <span class="s2">&quot;FALSE! -contains is for lists!&quot;</span><span class="p">;</span> <span class="k">break</span> <span class="p">}</span>
  <span class="k">default</span>                 <span class="p">{</span> <span class="s2">&quot;Others&quot;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="c"># The classic for</span>
<span class="k">for</span><span class="p">(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">-le</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
  <span class="s2">&quot;Loop number $i&quot;</span>
<span class="p">}</span>
<span class="c"># Or shorter</span>
<span class="n">1</span><span class="p">..</span><span class="n">10</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span> <span class="s2">&quot;Loop number $_&quot;</span> <span class="p">}</span>

<span class="c"># PowerShell also offers</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$var</span> <span class="k">in</span> <span class="s1">&#39;val1&#39;</span><span class="p">,</span><span class="s1">&#39;val2&#39;</span><span class="p">,</span><span class="s1">&#39;val3&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="n">echo</span> <span class="nv">$var</span> <span class="p">}</span>
<span class="c"># while () {}</span>
<span class="c"># do {} while ()</span>
<span class="c"># do {} until ()</span>

<span class="c"># Exception handling</span>
<span class="k">try</span> <span class="p">{}</span> <span class="k">catch</span> <span class="p">{}</span> <span class="k">finally</span> <span class="p">{}</span>
<span class="k">try</span> <span class="p">{}</span> <span class="k">catch</span> <span class="no">[System.NullReferenceException]</span> <span class="p">{</span>
    <span class="n">echo</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Exception</span> <span class="p">|</span> <span class="nb">Format-List</span> <span class="n">-Force</span>
<span class="p">}</span>


<span class="c">### Providers</span>
<span class="c"># List files and directories in the current directory</span>
<span class="n">ls</span> <span class="c"># or `dir`</span>
<span class="n">cd</span> <span class="p">~</span> <span class="c"># goto home</span>

<span class="nb">Get-Alias</span> <span class="n">ls</span> <span class="c"># -&gt; Get-ChildItem</span>
<span class="c"># Uh!? These cmdlets have generic names because unlike other scripting</span>
<span class="c"># languages, PowerShell does not only operate in the current directory.</span>
<span class="n">cd</span> <span class="n">HKCU</span><span class="err">:</span> <span class="c"># go to the HKEY_CURRENT_USER registry hive</span>

<span class="c"># Get all providers in your session</span>
<span class="nb">Get-PSProvider</span>


<span class="c">### Pipeline</span>
<span class="c"># Cmdlets have parameters that control their execution:</span>
<span class="nb">Get-ChildItem</span> <span class="n">-Filter</span> <span class="p">*.</span><span class="n">txt</span> <span class="n">-Name</span> <span class="c"># Get just the name of all txt files</span>
<span class="c"># Only need to type as much of a parameter name until it is no longer ambiguous</span>
<span class="n">ls</span> <span class="n">-fi</span> <span class="p">*.</span><span class="n">txt</span> <span class="n">-n</span> <span class="c"># -f is not possible because -Force also exists</span>
<span class="c"># Use `Get-Help Get-ChildItem -Full` for a complete overview</span>

<span class="c"># Results of the previous cmdlet can be passed to the next as input.</span>
<span class="c"># `$_` is the current object in the pipeline object.</span>
<span class="n">ls</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s1">&#39;c&#39;</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">Export-CSV</span> <span class="n">export</span><span class="p">.</span><span class="n">txt</span>
<span class="n">ls</span> <span class="p">|</span> <span class="p">?</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-match</span> <span class="s1">&#39;c&#39;</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">ConvertTo-HTML</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">export</span><span class="p">.</span><span class="n">html</span>

<span class="c"># If you get confused in the pipeline use `Get-Member` for an overview</span>
<span class="c"># of the available methods and properties of the pipelined objects:</span>
<span class="n">ls</span> <span class="p">|</span> <span class="nb">Get-Member</span>
<span class="nb">Get-Date</span> <span class="p">|</span> <span class="n">gm</span>

<span class="c"># ` is the line continuation character. Or end the line with a |</span>
<span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">ID</span> <span class="n">-Descending</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-First</span> <span class="n">10</span> <span class="n">Name</span><span class="p">,</span><span class="n">ID</span><span class="p">,</span><span class="n">VM</span> <span class="p">`</span>
    <span class="p">|</span> <span class="nb">Stop-Process</span> <span class="n">-WhatIf</span>

<span class="nb">Get-EventLog</span> <span class="n">Application</span> <span class="n">-After</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">AddHours</span><span class="p">(-</span><span class="n">2</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Format-List</span>

<span class="c"># Use % as a shorthand for ForEach-Object</span>
<span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span> <span class="p">|</span> <span class="k">ForEach</span><span class="n">-Object</span> <span class="p">`</span>
    <span class="n">-Begin</span> <span class="p">{</span> <span class="s2">&quot;Starting&quot;</span><span class="p">;</span> <span class="nv">$counter</span> <span class="p">=</span> <span class="n">0</span> <span class="p">}</span> <span class="p">`</span>
    <span class="n">-Process</span> <span class="p">{</span> <span class="s2">&quot;Processing $_&quot;</span><span class="p">;</span> <span class="nv">$counter</span><span class="p">++</span> <span class="p">}</span> <span class="p">`</span>
    <span class="n">-End</span> <span class="p">{</span> <span class="s2">&quot;Finishing: $counter&quot;</span> <span class="p">}</span>

<span class="c"># Get-Process as a table with three columns</span>
<span class="c"># The third column is the value of the VM property in MB and 2 decimal places</span>
<span class="c"># Computed columns can be written more verbose as:</span>
<span class="c"># `@{name=&#39;lbl&#39;;expression={$_}`</span>
<span class="n">ps</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">ID</span><span class="p">,</span><span class="n">Name</span><span class="p">,@{</span><span class="n">n</span><span class="p">=</span><span class="s1">&#39;VM(MB)&#39;</span><span class="p">;</span><span class="n">e</span><span class="p">={</span><span class="s1">&#39;{0:n2}&#39;</span> <span class="o">-f</span> <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">VM</span> <span class="p">/</span> <span class="n">1MB</span><span class="p">)}}</span> <span class="n">-autoSize</span>


<span class="c">### Functions</span>
<span class="c"># The [string] attribute is optional.</span>
<span class="k">function</span> <span class="n">foo</span><span class="p">(</span><span class="no">[string]</span><span class="nv">$name</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">echo</span> <span class="s2">&quot;Hey $name, have a function&quot;</span>
<span class="p">}</span>

<span class="c"># Calling your function</span>
<span class="n">foo</span> <span class="s2">&quot;Say my name&quot;</span>

<span class="c"># Functions with named parameters, parameter attributes, parsable documentation</span>
<span class="cm">&lt;#</span>
<span class="sd">.SYNOPSIS</span><span class="cm"></span>
<span class="cm">Setup a new website</span>
<span class="sd">.DESCRIPTION</span><span class="cm"></span>
<span class="cm">Creates everything your new website needs for much win</span>
<span class="sd">.PARAMETER</span><span class="cm"> siteName</span>
<span class="cm">The name for the new website</span>
<span class="sd">.EXAMPLE</span><span class="cm"></span>
<span class="cm">New-Website -Name FancySite -Po 5000</span>
<span class="cm">New-Website SiteWithDefaultPort</span>
<span class="cm">New-Website siteName 2000 # ERROR! Port argument could not be validated</span>
<span class="cm">(&#39;name1&#39;,&#39;name2&#39;) | New-Website -Verbose</span>
<span class="cm">#&gt;</span>
<span class="k">function</span> <span class="nb">New-Website</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">[</span><span class="k">CmdletBinding</span><span class="p">()]</span>
    <span class="k">param</span> <span class="p">(</span>
        <span class="p">[</span><span class="k">Parameter</span><span class="p">(</span><span class="k">ValueFromPipeline</span><span class="p">=</span><span class="nv">$true</span><span class="p">,</span> <span class="k">Mandatory</span><span class="p">=</span><span class="nv">$true</span><span class="p">)]</span>
        <span class="p">[</span><span class="k">Alias</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)]</span>
        <span class="no">[string]</span><span class="nv">$siteName</span><span class="p">,</span>
        <span class="p">[</span><span class="k">ValidateSet</span><span class="p">(</span><span class="n">3000</span><span class="p">,</span><span class="n">5000</span><span class="p">,</span><span class="n">8000</span><span class="p">)]</span>
        <span class="no">[int]</span><span class="nv">$port</span> <span class="p">=</span> <span class="n">3000</span>
    <span class="p">)</span>
    <span class="k">BEGIN</span> <span class="p">{</span> <span class="nb">Write-Verbose</span> <span class="s1">&#39;Creating new website(s)&#39;</span> <span class="p">}</span>
    <span class="k">PROCESS</span> <span class="p">{</span> <span class="n">echo</span> <span class="s2">&quot;name: $siteName, port: $port&quot;</span> <span class="p">}</span>
    <span class="k">END</span> <span class="p">{</span> <span class="nb">Write-Verbose</span> <span class="s1">&#39;Website(s) created&#39;</span> <span class="p">}</span>
<span class="p">}</span>


<span class="c">### It&#39;s all .NET</span>
<span class="c"># A PS string is in fact a .NET System.String</span>
<span class="c"># All .NET methods and properties are thus available</span>
<span class="s1">&#39;string&#39;</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">().</span><span class="n">Replace</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;ggg&#39;</span><span class="p">)</span>
<span class="c"># Or more powershellish</span>
<span class="s1">&#39;string&#39;</span><span class="p">.</span><span class="n">ToUpper</span><span class="p">()</span> <span class="o">-replace</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;ggg&#39;</span>

<span class="c"># Unsure how that .NET method is called again?</span>
<span class="s1">&#39;string&#39;</span> <span class="p">|</span> <span class="n">gm</span>

<span class="c"># Syntax for calling static .NET methods</span>
<span class="p">\</span><span class="no">[System.Reflection.Assembly]</span><span class="p">::</span><span class="n">LoadWithPartialName</span><span class="p">(</span><span class="s1">&#39;Microsoft.VisualBasic&#39;</span><span class="p">)</span>

<span class="c"># Note that .NET functions MUST be called with parentheses</span>
<span class="c"># while PS functions CANNOT be called with parentheses.</span>
<span class="c"># If you do call a cmdlet/PS function with parentheses,</span>
<span class="c"># it is the same as passing a single parameter list</span>
<span class="nv">$writer</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IO</span><span class="p">.</span><span class="n">StreamWriter</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="nv">$true</span><span class="p">)</span>
<span class="nv">$writer</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="no">[Environment]</span><span class="p">::</span><span class="n">NewLine</span><span class="p">)</span>
<span class="nv">$writer</span><span class="p">.</span><span class="n">Dispose</span><span class="p">()</span>

<span class="c">### IO</span>
<span class="c"># Reading a value from input:</span>
<span class="nv">$Name</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;What&#39;s your name?&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;Hello, $Name!&quot;</span>
<span class="no">[int]</span><span class="nv">$Age</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;What&#39;s your age?&quot;</span>

<span class="c"># Test-Path, Split-Path, Join-Path, Resolve-Path</span>
<span class="c"># Get-Content filename # returns a string[]</span>
<span class="c"># Set-Content, Add-Content, Clear-Content</span>
<span class="nb">Get-Command</span> <span class="n">ConvertTo</span><span class="p">-*,</span><span class="n">ConvertFrom</span><span class="p">-*</span>


<span class="c">### Useful stuff</span>
<span class="c"># Refresh your PATH</span>
<span class="nv">$env:PATH</span> <span class="p">=</span> <span class="no">[System.Environment]</span><span class="p">::</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="s2">&quot;Machine&quot;</span><span class="p">)</span> <span class="p">+</span> 
    <span class="s2">&quot;;&quot;</span> <span class="p">+</span> <span class="no">[System.Environment]</span><span class="p">::</span><span class="n">GetEnvironmentVariable</span><span class="p">(</span><span class="s2">&quot;Path&quot;</span><span class="p">,</span> <span class="s2">&quot;User&quot;</span><span class="p">)</span>

<span class="c"># Find Python in path</span>
<span class="nv">$env:PATH</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span> <span class="p">|</span> <span class="nb">Where-Object</span> <span class="p">{</span> <span class="nv">$_</span> <span class="o">-like</span> <span class="s2">&quot;*python*&quot;</span><span class="p">}</span>

<span class="c"># Change working directory without having to remember previous path</span>
<span class="nb">Push-Location</span> <span class="n">c</span><span class="err">:</span><span class="p">\</span><span class="n">temp</span> <span class="c"># change working directory to c:\temp</span>
<span class="nb">Pop-Location</span> <span class="c"># change back to previous working directory</span>
<span class="c"># Aliases are: pushd and popd</span>

<span class="c"># Unblock a directory after download</span>
<span class="nb">Get-ChildItem</span> <span class="n">-Recurse</span> <span class="p">|</span> <span class="n">Unblock</span><span class="o">-File</span>

<span class="c"># Open Windows Explorer in working directory</span>
<span class="n">ii</span> <span class="p">.</span>

<span class="c"># Any key to exit</span>
<span class="nv">$host</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">RawUI</span><span class="p">.</span><span class="n">ReadKey</span><span class="p">()</span>
<span class="k">return</span>

<span class="c"># Create a shortcut</span>
<span class="nv">$WshShell</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">-comObject</span> <span class="n">WScript</span><span class="p">.</span><span class="n">Shell</span>
<span class="nv">$Shortcut</span> <span class="p">=</span> <span class="nv">$WshShell</span><span class="p">.</span><span class="n">CreateShortcut</span><span class="p">(</span><span class="nv">$link</span><span class="p">)</span>
<span class="nv">$Shortcut</span><span class="p">.</span><span class="n">TargetPath</span> <span class="p">=</span> <span class="nv">$file</span>
<span class="nv">$Shortcut</span><span class="p">.</span><span class="n">WorkingDirectory</span> <span class="p">=</span> <span class="nb">Split-Path</span> <span class="nv">$file</span>
<span class="nv">$Shortcut</span><span class="p">.</span><span class="n">Save</span><span class="p">()</span>
</pre></div>
<p>Configuring your shell</p>
<div class="highlight"><pre><span></span><span class="c"># $Profile is the full path for your `Microsoft.PowerShell_profile.ps1`</span>
<span class="c"># All code there will be executed when the PS session starts</span>
<span class="k">if</span> <span class="p">(</span><span class="o">-not</span> <span class="p">(</span><span class="nb">Test-Path</span> <span class="nv">$Profile</span><span class="p">))</span> <span class="p">{</span>
    <span class="nb">New-Item</span> <span class="n">-Type</span> <span class="n">file</span> <span class="n">-Path</span> <span class="nv">$Profile</span> <span class="n">-Force</span>
    <span class="n">notepad</span> <span class="nv">$Profile</span>
<span class="p">}</span>
<span class="c"># More info: `help about_profiles`</span>
<span class="c"># For a more useful shell, be sure to check the project PSReadLine below</span>
</pre></div>
<p>Interesting Projects  </p>

<ul>
<li><a href="https://channel9.msdn.com/Search?term=powershell%20pipeline#ch9Search&amp;lang-en=en">Channel9</a> PowerShell tutorials</li>
<li><a href="https://github.com/psget/psget">PSGet</a> NuGet for PowerShell</li>
<li><a href="https://github.com/lzybkr/PSReadLine/">PSReadLine</a> A bash inspired readline implementation for PowerShell (So good that it now ships with Windows10 by default!)</li>
<li><a href="https://github.com/dahlbyk/posh-git/">Posh-Git</a> Fancy Git Prompt (Recommended!)</li>
<li><a href="https://github.com/psake/psake">PSake</a> Build automation tool</li>
<li><a href="https://github.com/pester/Pester">Pester</a> BDD Testing Framework</li>
<li><a href="https://github.com/tkellogg/Jump-Location">Jump-Location</a> Powershell <code>cd</code> that reads your mind</li>
<li><a href="http://pscx.codeplex.com/">PowerShell Community Extensions</a> (Dead)</li>
</ul>

<p>Not covered  </p>

<ul>
<li>WMI: Windows Management Intrumentation (Get-CimInstance)<br></li>
<li>Multitasking: Start-Job -scriptBlock {&hellip;}, </li>
<li>Code Signing</li>
<li>Remoting (Enter-PSSession/Exit-PSSession; Invoke-Command)</li>
</ul>

    <hr>
    <p>Got a suggestion? A correction, perhaps? <a href="https://github.com/adambard/learnxinyminutes-docs/issues/new">Open an Issue</a> on the Github Repo, or make a <a href="https://github.com/adambard/learnxinyminutes-docs/edit/master/powershell.html.markdown">pull request</a> yourself!
    </p>
    <p class="contributed">
    Originally contributed by Wouter Van Schandevijl, and updated by <a href="https://github.com/adambard/learnxinyminutes-docs/blame/master/powershell.html.markdown">7 contributor(s)</a>.
    </p>

    <footer>
    <a style="float: left" rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a>
    <p>
    &copy; 2019
        <a href="https://github.com/laoujin">Wouter Van Schandevijl</a>
    </p>

    <p>

    </footer>
  </div>

        </div>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
        <script src="/js/script.js"></script>

        <script>
            var _gaq=[['_setAccount','UA-3525624-21'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
